package me.WhiteGrits.Lightninglogin;

import java.util.logging.Logger;

import org.bukkit.Bukkit;
import org.bukkit.ChatColor;
import org.bukkit.entity.LightningStrike;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.player.PlayerJoinEvent;
import org.bukkit.permissions.Permission;
import org.bukkit.plugin.PluginDescriptionFile;
import org.bukkit.plugin.PluginManager;
import org.bukkit.plugin.java.JavaPlugin;
 
public class Main extends JavaPlugin implements Listener {
	public final Logger logger = Logger.getLogger("Minecraft");
	public static Main plugin;
	
	    public Permission playerPermission = new Permission("lightninglogin.allow");
	 
	    public void onDisable() {
		        PluginDescriptionFile pdfFile = this.getDescription();
		        this.logger.info(pdfFile.getName() + " Has Been Disabled!");
	}
        public void onEnable(){
                Bukkit.getServer().getPluginManager().registerEvents(this, this);
                PluginDescriptionFile pdfFile = this.getDescription();
        		this.logger.info(pdfFile.getName() + " Version" + pdfFile.getVersion() + " Has Been Enabled!");
        		PluginManager pm = getServer().getPluginManager();
        		pm.addPermission(playerPermission);
        }
        
       
        @EventHandler
        public void onPlayerJoin (final PlayerJoinEvent pje) {
                        Bukkit.getServer().getScheduler().scheduleSyncDelayedTask(this, new Runnable(){
                                public void run(){
                                       
            	                        Player player = pje.getPlayer();
            	                        if (player.hasPermission("lightninglogin.allow")) ;
            	                        	
            	                        
                                        @SuppressWarnings("unused")
										LightningStrike f  = (LightningStrike) pje.getPlayer().getWorld().spawn(pje.getPlayer().getLocation(), LightningStrike.class);
                                        
                                    
                                }
                        }, 18);
        }
        
        @EventHandler
        public void onPlayerJoin1 (final PlayerJoinEvent pj) {
        	Bukkit.getServer().getScheduler().scheduleSyncDelayedTask(this, new Runnable(){
                public void run(){
                	                    Player player = pj.getPlayer();
                	                    if (player.hasPermission("lightninglogin.allow")) ;
                	                    	
                	                    
        	                            player.sendMessage(ChatColor.LIGHT_PURPLE  + "Lightning strikes as you login!");
        	                            
                }
        	}, 18);
        	


        }
        
        
}
